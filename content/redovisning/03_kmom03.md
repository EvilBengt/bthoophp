---
---
Redovisning kmom03
=========================

Detta innehåll är skrivet i markdown och du hittar innehållet i filen `content/redovisning/03_kmom03.md`.

Har du tidigare erfarenheter av att skriva kod som testar annan kod?
--------------------------------------------------------------------

Japp! I en C#-kurs jag läste för ett och ett halvt år sedan skrev vi lite enhetstester till slutprojektet.
Jag har sedan dess försökt övertala mig själv att testa min egna kod (i C#) men har oftast inte kommit så
långt med det. Jag tycker visserligen enhetstestning är bra och jag förstår hur viktigt det är, men när man
håller på och kodar på något eget roligt projekt är det svårt att övertala sig att ta paus och skriva tester.
I min erfarenhet är det (såklart) oftast roligare att bara skriva på så det händer något. Alternativt
spenderar jag flera timmar eller till och med dagar på att fundera igenom en feature så jag vill inte lägga
tid på testning sedan.

Hur ser du på begreppen enhetstestning och “att skriva testbar kod”?
--------------------------------------------------------------------

Jag gillar konceptet både med enhetstestning och att skriva testbar kod från början. Det är alltid roligt att
bygga organiserad och strukturerad kod. För några månader sedan när jag höll på och lära mig att implementera
designmönster skrev jag på ett eget litet spel i C# (som "ligger på hyllan" sedan några färre månader tillbaka).
I det projektet tänkte jag att jag skulle gå in för att göra allting 100% testbart så jag provade på dependency
injection (constructor injection). Efter att ha byggt x antal
ThingThatMakesFactoryStrategyFactoryDecoratorFactories och liknande gav jag upp och insåg att jag borde börja
om någon gång men med någon slags di-container.

Som sagt, konceptet testbar kod och enhetstestning känns som en viktig del i hållbar utveckling men det går nog
att göra det på fel sätt med.

Förklara kort begreppen white/grey/black box testing samt positiva och negativa tester, med dina egna ord.
----------------------------------------------------------------------------------------------------------

White/grey/black box testing motsvara olika förutsättningar när man testar ett system. Det vi gjort i detta
kursmomentet är white box testing då vi för det första har byggt koden själva och även har full tillgång till
den och vet hur den fungerar. Det handlar alltså om hur mycket tillgång till / hur mycket vi vet om kodens
uppbyggnad. Black box testing skulle vara att man kanske får se ett interface för en klass med metodsignaturer
men man ser vet inget om den faktiska koden inuti metoderna.

Jag kan tänka mig att black box testing kan ge bättre tester då man inte påverkas av metodernas uppbyggnad utan
man kanske går efter någon extern kravspec. Det kan nog bli bättre då för då testar man bara sådant som behöver
testas och man drar inga förhastade slutsatser om hur koden fungerar och beter sig.

Med positiva respektive negativa tester menas att man testar metoder på det sätter de ska användas på respektive
fel sätt. Ett negativt test kan vara att man mosar in en integer där det ska vara en `Banana` eller annat och
testar att metoden hanterar det på ett snyggt sätt med rätt sorts exception och liknande.

Berätta om hur du löste uppgiften med Tärningsspelet 100, hur du tänkte, planerade och utförde uppgiften samt hur du organiserade din kod?
------------------------------------------------------------------------------------------------------------------------------------------

Min tanke var att återanvända klasserna `Dice` och `DiceHand` från guiden. För att hantera mer data så som poäng
wrappade jag `DiceHand` i en `Player`-klass. `Player`-klassen använder jag sedan i två instanser för att
representera datorn och spelaren. För den mer generella spellogiken har jag en `Game`-klass som håller i de två
spelarna och sköter allt annat.

För att kunna bygga klasserna så intuitivt och enkelt som möjlig (typ) valde jag även denna gången att dumpa in hela
`Game`-objektet i sessionen. Jag antar att endast properties lagras och inte metoddefinitionerna så det borde inte
bli allt för mycket data. I ett större system hade detta nog inte varit särskilt hållbart dock.Fördelen med att
spara hela systemet i sessionen tänker jag är att man inte behöver instansiera klasserna varje gång med en massa
data som egentligen inte har utanför klasserna att göra. På så sätt blir konstruktor-metoderna väldigt enkla och
flödet i programmet fungerar "som vanligt" utan att man ens behöver tänka på sessionen väl inne i programmet. Jag
skulle nog kunna säga att detta även leder till att källkoden helt utan modifiering skulle kunna flyttas till ett
CLI eller liknande med beständig state utan problem.

Jag bröt även ut vyerna till olika delar och då olika vy-filer som jag sedan slår ihop i routern. Jag har till
exempel en vy för rubrik och poäng som alltid visas och sedan olika vyer under den beroende på var i spelet man
är.

Hur väl lyckades du testa tärningsspelet 100?
---------------------------------------------

Jag lyckades få till 100% kodtäckning. Alla tänkbara scenarier är dock inte testade då jag nog skulle få fullt upp
resten av veckan. Jag tyckte dock inte det kändes komplett och riktigt att testa metoder som beror på andra klasser
så jag byggde om lite i systemet i slutet för att få till dependency-injectionen genom interfaces och till och med
en factory. Factory:n var för att jag inte ville behöva skapa flera tärningar för varje `DiceHand` vid instantiering
så jag ger den en factory och en integer för hur många tärningar jag vill ha. När jag testar kan jag sedan bara
injecta en mock-klass som i det fallet bara skapar ensidiga tärningar. Jag har även mock-klasser för Dice och Player
för att kunna testa de klasserna där de används.

Först lade jag de mock-klasserna i test-filen där de används men validatorn sa tvärt nej, vilket jag ändå håller med
om. Varje klass ska ha en egen fil så jag lade dem i en Mocking-mapp i test-mappen. Jag kände inte att jag kunde lägga
tid på att få in dem i autoloadern på något sätt så jag slängde på några enkla require-once som fungerade perfekt.

Vilken är din TIL för detta kmom?
---------------------------------

Det var inte jätte mycket som var *helt* nytt för mig så inget som jag reagerade över så. Ibland lär man sig lite av
mycket och ibland mycket av lite. Lite av mycket är inget fel på, men det är svårare att komma på något särskilt som
man reagerade över. Jag får nog passa och försöka komma på något bättre till nästa kmom :D
